{"version":3,"file":"cluster.js","sourceRoot":"","sources":["../../src/cluster.ts"],"names":[],"mappings":"AAAA;;;;;;;;GAQG;;AAiLH,YAAY","sourcesContent":["/**\n * ```ts\n * import type { ClusterImbalanceInfo } from \"arangojs/cluster\";\n * ```\n *\n * The \"cluster\" module provides types for cluster management.\n *\n * @packageDocumentation\n */\n\n//#region Cluster operation options\n/**\n * Options for rebalancing the cluster.\n */\nexport type ClusterRebalanceOptions = {\n  /**\n   * Maximum number of moves to be computed.\n   *\n   * Default: `1000`\n   */\n  maximumNumberOfMoves?: number;\n  /**\n   * Allow leader changes without moving data.\n   *\n   * Default: `true`\n   */\n  leaderChanges?: boolean;\n  /**\n   * Allow moving leaders.\n   *\n   * Default: `false`\n   */\n  moveLeaders?: boolean;\n  /**\n   * Allow moving followers.\n   *\n   * Default: `false`\n   */\n  moveFollowers?: boolean;\n  /**\n   * Ignore system collections in the rebalance plan.\n   *\n   * Default: `false`\n   */\n  excludeSystemCollections?: boolean;\n  /**\n   * Default: `256**6`\n   */\n  piFactor?: number;\n  /**\n   * A list of database names to exclude from the analysis.\n   *\n   * Default: `[]`\n   */\n  databasesExcluded?: string[];\n};\n//#endregion\n\n//#region Cluster operation results\n/**\n * The result of a cluster rebalance.\n */\nexport type ClusterRebalanceResult = {\n  /**\n   * Imbalance before the suggested move shard operations are applied.\n   */\n  imbalanceBefore: ClusterImbalanceInfo;\n  /**\n   * Expected imbalance after the suggested move shard operations are applied.\n   */\n  imbalanceAfter: ClusterImbalanceInfo;\n  /**\n   * Suggested move shard operations.\n   */\n  moves: ClusterRebalanceMove[];\n};\n\n/**\n * Information about the current state of the cluster imbalance.\n */\nexport type ClusterRebalanceState = ClusterImbalanceInfo & {\n  /**\n   * The number of pending move shard operations.\n   */\n  pendingMoveShards: number;\n  /**\n   * The number of planned move shard operations.\n   */\n  todoMoveShards: number;\n};\n\n/**\n * Information about a cluster imbalance.\n */\nexport type ClusterImbalanceInfo = {\n  /**\n   * Information about the leader imbalance.\n   */\n  leader: {\n    /**\n     * The weight of leader shards per DB-Server. A leader has a weight of 1 by default but it is higher if collections can only be moved together because of `distributeShardsLike`.\n     */\n    weightUsed: number[];\n    /**\n     * The ideal weight of leader shards per DB-Server.\n     */\n    targetWeight: number[];\n    /**\n     * The number of leader shards per DB-Server.\n     */\n    numberShards: number[];\n    /**\n     * The measure of the leader shard distribution. The higher the number, the worse the distribution.\n     */\n    leaderDupl: number[];\n    /**\n     * The sum of all weights.\n     */\n    totalWeight: number;\n    /**\n     * The measure of the total imbalance. A high value indicates a high imbalance.\n     */\n    imbalance: number;\n    /**\n     * The sum of shards, counting leader shards only.\n     */\n    totalShards: number;\n  };\n  /**\n   * Information about the shard imbalance.\n   */\n  shards: {\n    /**\n     * The size of shards per DB-Server.\n     */\n    sizeUsed: number[];\n    /**\n     * The ideal size of shards per DB-Server.\n     */\n    targetSize: number[];\n    /**\n     * The number of leader and follower shards per DB-Server.\n     */\n    numberShards: number[];\n    /**\n     * The sum of the sizes.\n     */\n    totalUsed: number;\n    /**\n     * The sum of shards, counting leader and follower shards.\n     */\n    totalShards: number;\n    /**\n     * The sum of system collection shards, counting leader shards only.\n     */\n    totalShardsFromSystemCollections: number;\n    /**\n     * The measure of the total imbalance. A high value indicates a high imbalance.\n     */\n    imbalance: number;\n  };\n};\n\nexport type ClusterRebalanceMove = {\n  /**\n   * The server name from which to move.\n   */\n  from: string;\n  /**\n   * The ID of the destination server.\n   */\n  to: string;\n  /**\n   * Shard ID of the shard to be moved.\n   */\n  shard: string;\n  /**\n   * Collection ID of the collection the shard belongs to.\n   */\n  collection: number;\n  /**\n   * True if this is a leader move shard operation.\n   */\n  isLeader: boolean;\n};\n//#endregion\n"]}